x=linspace(0,1,200);
y=linspace(0,1,200);
[x,y]=meshgrid(x,y);
z=point_to_circle_distance(x,y,0.40,0.7,0.2)+point_to_circle_distance(x,y,0.60,0.7,0.2)+point_to_circle_distance(x,y,0.5,0.1,0.1);
surf(x,y,z)
figure
z=point_to_circle_distance(x,y,0.40,0.7,0.2)+point_to_circle_distance(x,y,0.60,0.7,0.2)+point_to_circle_distance(x,y,0.5,0.1,0.9);
surf(x,y,z)


(sqrt((x-0.40)^2+(y-0.7)^2) - 0.2)^2 + (sqrt((x-0.60)^2+(y-0.7)^2) - 0.2)^2 + (sqrt((x-0.50)^2+(y-0.1)^2) - 0.1)^2

x0 = [0,0];
options = optimoptions(@fminunc,'Algorithm','quasi-newton');
fminunc(@X_optimize_example,x0,options)

x0 = [0,0];
options = optimoptions(@fminunc,'Algorithm','quasi-newton');
fminunc(@X_optimize_multiple,x0,options)

inX = [0.4, 0.6, 0.5]
inY = [0.7, 0.7, 0.1]
inR = [0.2, 0.2, 0.1]

fminunc(@(x)X_optimize_multiple(x,inX,inY,inR),x0,options)

inX = [0.2, 0.2, 0.4, 0.4, 0.6, 0.6, 0.8, 0.8];
inY = [0.7, 0.3, 0.7, 0.3, 0.7, 0.3, 0.7, 0.3];
inZ = [0.4, 0.6, 0.6, 0.4, 0.4, 0.6, 0.6, 0.4];
points = [0, 0.5, 0.5; 0.1, 0.5, 0.5; 0.2, 0.5, 0.5; 0.3, 0.5, 0.5; 0.4, 0.5, 0.5; 0.5, 0.5, 0.5; 0.6, 0.5, 0.5; 0.7, 0.5, 0.5; 0.8, 0.5, 0.5; 0.9, 0.5, 0.5; 1, 0.5, 0.5];

Y_calculate_R(points,inX,inY,inZ)

inR = [0.300000000000000, 0.300000000000000, 0.458257569495584, 0.458257569495584, 0.640312423743285, 0.640312423743285, 0.830662386291808, 0.830662386291808;
0.244948974278318, 0.244948974278318, 0.374165738677394, 0.374165738677394, 0.547722557505166, 0.547722557505166, 0.734846922834954, 0.734846922834954;
0.223606797749979, 0.223606797749979, 0.300000000000000, 0.300000000000000, 0.458257569495584, 0.458257569495584, 0.640312423743285, 0.640312423743285;
0.244948974278318, 0.244948974278318, 0.244948974278318, 0.244948974278318, 0.374165738677394, 0.374165738677394, 0.547722557505166, 0.547722557505166;
0.300000000000000, 0.300000000000000, 0.223606797749979, 0.223606797749979, 0.300000000000000, 0.300000000000000, 0.458257569495584, 0.458257569495584;
0.374165738677394, 0.374165738677394, 0.244948974278318, 0.244948974278318, 0.244948974278318, 0.244948974278318, 0.374165738677394, 0.374165738677394;
0.458257569495584, 0.458257569495584, 0.300000000000000, 0.300000000000000, 0.223606797749979, 0.223606797749979, 0.300000000000000, 0.300000000000000;
0.547722557505166, 0.547722557505166, 0.374165738677394, 0.374165738677394, 0.244948974278318, 0.244948974278318, 0.244948974278318, 0.244948974278318;
0.640312423743285, 0.640312423743285, 0.458257569495584, 0.458257569495584, 0.300000000000000, 0.300000000000000, 0.223606797749979, 0.223606797749979;
0.734846922834953, 0.734846922834953, 0.547722557505166, 0.547722557505166, 0.374165738677394, 0.374165738677394, 0.244948974278318, 0.244948974278318;
0.830662386291808, 0.830662386291808, 0.640312423743285, 0.640312423743285, 0.458257569495584, 0.458257569495584, 0.300000000000000, 0.300000000000000];

WITH ERROR 0.2
inR = [0.324238886953931, 0.254466243831569, 0.549001555959526, 0.539629602304792, 0.713918243335450, 0.671501987554215, 0.980417870042740, 0.701440749162082;
0.281879076295705, 0.271213851760461, 0.401865111125861, 0.406980065943710, 0.570997469418706, 0.467870295781569, 0.754766087543156, 0.689676787118581;
0.239551414460905, 0.209217074557478, 0.279399206391149, 0.265737775227466, 0.434755118455219, 0.447456966255179, 0.631866890406928, 0.580044232689300;
0.283176390926413, 0.200897963592414, 0.239965959063902, 0.283696164093086, 0.435713337398682, 0.323249122410818, 0.566203012314213, 0.536091626677359;
0.356810116035057, 0.333253439407981, 0.264389770228273, 0.200082120983218, 0.247645295923290, 0.267507206190203, 0.509842935105609, 0.543462693239795;
0.332963284591278, 0.431759591051960, 0.288729554547275, 0.214297540232806, 0.256794802492451, 0.280473575275074, 0.345551659776384, 0.325072940825131;
0.499343209924982, 0.474042425839591, 0.294752197899659, 0.294458934341056, 0.189467557472445, 0.178935297827952, 0.348507253277544, 0.259057951673418;
0.623544072167169, 0.542615176625858, 0.346635648618845, 0.318291247187448, 0.261843105282127, 0.285620977048761, 0.229511422395384, 0.215956963597422;
0.659427489162390, 0.651139335384424, 0.435779325113862, 0.382403163711854, 0.290315308898597, 0.316954313035741, 0.190154465737740, 0.240022355521297;
0.832257580888109, 0.839198791163716, 0.569860937575481, 0.614143075883314, 0.407860384651762, 0.404275848548609, 0.287898030429323, 0.214464069465839;
0.964946278505202, 0.971360674337895, 0.697876702372361, 0.608064285893378, 0.495317652193896, 0.400212760647417, 0.352808165832229, 0.267314895085307];

[result, error] = Z_rez_3d( inX, inY, inZ, inR, points )


result =

   -0.0302    0.4019    0.4437
    0.1009    0.4744    0.5084
    0.2319    0.4840    0.4891
    0.3006    0.4726    0.5789
    0.3992    0.4883    0.4699
    0.5179    0.4979    0.4322
    0.6108    0.4785    0.4833
    0.7104    0.4899    0.4922
    0.7874    0.5116    0.4982
    0.9601    0.4836    0.4775
    1.0406    0.4227    0.4926


error =

    0.0307
	
result =

   -0.0302    0.4019    0.4437
    0.1009    0.4744    0.5084
    0.2319    0.4840    0.4891
    0.3006    0.4726    0.5789
    0.3992    0.4883    0.4699
    0.5179    0.4979    0.4322
    0.6108    0.4785    0.4833
    0.7104    0.4899    0.4922
    0.7874    0.5116    0.4982
    0.9601    0.4836    0.4775
    1.0406    0.4227    0.4926


error =

    0.0307